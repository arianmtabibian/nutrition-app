{"ast":null,"code":"import _objectSpread from\"C:/Users/arian/OneDrive/Desktop/Nutrition/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import{useAuth}from'../contexts/AuthContext';import{Heart,MessageCircle,Share,MoreHorizontal,Bookmark,Image,X,ChevronLeft,ChevronRight}from'lucide-react';import{formatDistanceToNow,format,startOfMonth,endOfMonth,eachDayOfInterval,isToday,addMonths,subMonths}from'date-fns';import{useNavigate}from'react-router-dom';import{diaryAPI,mealsAPI,profileAPI}from'../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Feed=()=>{var _user$first_name,_user$username,_user$first_name2,_user$username2,_user$first_name4,_user$username4;const{user}=useAuth();const navigate=useNavigate();const[posts,setPosts]=useState([]);const[loading,setLoading]=useState(true);const[showCreatePost,setShowCreatePost]=useState(false);const[newPost,setNewPost]=useState({content:'',imageFile:null,mealData:null,allowComments:true,hideLikeCount:false});const[expandedComments,setExpandedComments]=useState(new Set());const[comments,setComments]=useState({});const[newComments,setNewComments]=useState({});const[loadingComments,setLoadingComments]=useState(new Set());// Sidebar data states\nconst[profileData,setProfileData]=useState(null);const[todayNutrition,setTodayNutrition]=useState(null);const[currentDate,setCurrentDate]=useState(new Date());const[monthData,setMonthData]=useState(null);const[sidebarLoading,setSidebarLoading]=useState(true);// Follow people search states\nconst[showFollowSearch,setShowFollowSearch]=useState(false);const[searchQuery,setSearchQuery]=useState('');const[searchResults,setSearchResults]=useState([]);const[searchLoading,setSearchLoading]=useState(false);const formatPostDate=dateString=>{const postDate=new Date(dateString);const today=new Date();const isToday=postDate.toDateString()===today.toDateString();if(isToday){return\"Today at \".concat(postDate.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit',hour12:true}));}else{return formatDistanceToNow(postDate,{addSuffix:true});}};const loadMonthData=useCallback(async()=>{try{var _response$data$days,_response$data$days$f;const year=currentDate.getFullYear();const month=currentDate.getMonth()+1;console.log('ðŸ“… Feed Calendar: Loading month data for:',{year,month});// Use the EXACT same API call as Diary component\nconst response=await diaryAPI.getMonth(year,month);console.log('ðŸ“… Feed Calendar: Response received:',response.data);console.log('ðŸ“… Feed Calendar: Days with data:',((_response$data$days=response.data.days)===null||_response$data$days===void 0?void 0:(_response$data$days$f=_response$data$days.filter(d=>d.has_data))===null||_response$data$days$f===void 0?void 0:_response$data$days$f.length)||0);setMonthData(response.data);}catch(error){console.error('ðŸ“… Feed Calendar: Error loading month data:',error);setMonthData({days:[]});}},[currentDate]);const loadSidebarData=useCallback(async()=>{if(!user)return;setSidebarLoading(true);try{console.log('ðŸ“Š Feed: Loading sidebar data...');// Load profile data using the same API as Overview\nconst profileResponse=await profileAPI.get();if(profileResponse.data.profile){setProfileData(profileResponse.data);console.log('ðŸ“Š Feed: Profile data loaded:',profileResponse.data.profile);}// Load today's nutrition using the same method as Overview\nconst today=new Date().toISOString().split('T')[0];const mealsResponse=await mealsAPI.getByDate(today);console.log('ðŸ“Š Feed: Meals response:',mealsResponse.data);if(mealsResponse.data){var _profileResponse$data,_profileResponse$data2;// Calculate totals from meals (same as Overview)\nconst meals=mealsResponse.data.meals||[];const totalCalories=meals.reduce((sum,meal)=>sum+(meal.calories||0),0);const totalProtein=meals.reduce((sum,meal)=>sum+(meal.protein||0),0);const totalCarbs=meals.reduce((sum,meal)=>sum+(meal.carbs||0),0);const totalFat=meals.reduce((sum,meal)=>sum+(meal.fat||0),0);// Create nutrition data object (same structure as Overview)\nconst nutritionData={totalCalories:totalCalories,totalProtein:totalProtein,totalCarbs:totalCarbs,totalFat:totalFat,calorieGoal:((_profileResponse$data=profileResponse.data.profile)===null||_profileResponse$data===void 0?void 0:_profileResponse$data.daily_calories)||2000,proteinGoal:((_profileResponse$data2=profileResponse.data.profile)===null||_profileResponse$data2===void 0?void 0:_profileResponse$data2.daily_protein)||150};console.log('ðŸ“Š Feed: Calculated nutrition data:',nutritionData);setTodayNutrition(nutritionData);}// Load month data for calendar\nawait loadMonthData();}catch(error){console.error('ðŸ“Š Feed: Error loading sidebar data:',error);}finally{setSidebarLoading(false);}},[user,loadMonthData]);const loadPosts=async()=>{try{const response=await fetch('/api/social/feed',{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('nutritrack_auth_data'))}});if(response.ok){const data=await response.json();setPosts(data);}}catch(error){console.error('Error loading posts:',error);}finally{setLoading(false);}};const handleLike=async postId=>{try{const response=await fetch(\"/api/social/posts/\".concat(postId,\"/like\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('nutritrack_auth_data'))}});if(response.ok){const data=await response.json();setPosts(posts.map(post=>post.id===postId?_objectSpread(_objectSpread({},post),{},{is_liked:data.is_liked,likes_count:data.likes_count}):post));}}catch(error){console.error('Error liking post:',error);}};const handleBookmark=async postId=>{try{const response=await fetch(\"/api/social/posts/\".concat(postId,\"/bookmark\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('nutritrack_auth_data'))}});if(response.ok){const data=await response.json();setPosts(posts.map(post=>post.id===postId?_objectSpread(_objectSpread({},post),{},{is_bookmarked:data.is_bookmarked}):post));}}catch(error){console.error('Error bookmarking post:',error);}};const toggleComments=async postId=>{if(expandedComments.has(postId)){setExpandedComments(prev=>{const newSet=new Set(prev);newSet.delete(postId);return newSet;});}else{setExpandedComments(prev=>{const newSet=new Set(prev);newSet.add(postId);return newSet;});if(!comments[postId]){setLoadingComments(prev=>{const newSet=new Set(prev);newSet.add(postId);return newSet;});try{const response=await fetch(\"/api/social/posts/\".concat(postId,\"/comments\"),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('nutritrack_auth_data'))}});if(response.ok){const data=await response.json();setComments(prev=>_objectSpread(_objectSpread({},prev),{},{[postId]:data}));}}catch(error){console.error('Error loading comments:',error);}finally{setLoadingComments(prev=>{const newSet=new Set(prev);newSet.delete(postId);return newSet;});}}}};const handleAddComment=async postId=>{var _newComments$postId;const content=(_newComments$postId=newComments[postId])===null||_newComments$postId===void 0?void 0:_newComments$postId.trim();if(!content)return;try{const response=await fetch(\"/api/social/posts/\".concat(postId,\"/comments\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('nutritrack_auth_data'))},body:JSON.stringify({content})});if(response.ok){const newComment=await response.json();setComments(prev=>_objectSpread(_objectSpread({},prev),{},{[postId]:[...(prev[postId]||[]),newComment]}));setNewComments(prev=>_objectSpread(_objectSpread({},prev),{},{[postId]:''}));setPosts(posts.map(post=>post.id===postId?_objectSpread(_objectSpread({},post),{},{comments_count:post.comments_count+1}):post));}}catch(error){console.error('Error adding comment:',error);}};const handleCreatePost=async()=>{if(!newPost.content.trim()&&!newPost.imageFile)return;const formData=new FormData();formData.append('content',newPost.content);if(newPost.imageFile){formData.append('image',newPost.imageFile);}if(newPost.mealData){formData.append('meal_data',JSON.stringify(newPost.mealData));}formData.append('allow_comments',newPost.allowComments.toString());formData.append('hide_like_count',newPost.hideLikeCount.toString());try{const response=await fetch('/api/social/posts',{method:'POST',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('nutritrack_auth_data'))},body:formData});if(response.ok){const newPostData=await response.json();setPosts([newPostData,...posts]);setNewPost({content:'',imageFile:null,mealData:null,allowComments:true,hideLikeCount:false});setShowCreatePost(false);}}catch(error){console.error('Error creating post:',error);}};const handleImageUpload=event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(file){setNewPost(prev=>_objectSpread(_objectSpread({},prev),{},{imageFile:file}));}};const searchUsers=async query=>{if(!query.trim()){setSearchResults([]);return;}setSearchLoading(true);try{const response=await fetch(\"/api/social/users/search?q=\".concat(encodeURIComponent(query)),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('nutritrack_auth_data'))}});if(response.ok){const data=await response.json();setSearchResults(data);}}catch(error){console.error('Error searching users:',error);}finally{setSearchLoading(false);}};const handleFollow=async userId=>{try{const response=await fetch(\"/api/social/users/\".concat(userId,\"/follow\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('nutritrack_auth_data'))}});if(response.ok){setSearchResults(searchResults.map(user=>user.id===userId?_objectSpread(_objectSpread({},user),{},{is_following:!user.is_following}):user));}}catch(error){console.error('Error following user:',error);}};useEffect(()=>{if(user){loadPosts();loadSidebarData();}},[user,loadSidebarData]);useEffect(()=>{loadMonthData();},[loadMonthData]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-6 max-w-7xl mx-auto p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-80 flex-shrink-0 sticky top-6 self-start space-y-6 max-h-[calc(100vh-3rem)] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 relative overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-0 right-0 w-16 h-16 bg-blue-50 rounded-full -translate-y-8 translate-x-8\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-0 left-0 w-12 h-12 bg-purple-50 rounded-full translate-y-6 -translate-x-6\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative text-center\",children:[user!==null&&user!==void 0&&user.profile_picture?/*#__PURE__*/_jsxs(\"div\",{className:\"relative inline-block\",children:[/*#__PURE__*/_jsx(\"img\",{src:user.profile_picture,alt:\"Profile\",className:\"w-20 h-20 rounded-full mx-auto mb-4 object-cover ring-3 ring-blue-100 shadow-md\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"relative inline-block\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 rounded-full bg-blue-500 flex items-center justify-center text-white text-xl font-semibold mx-auto mb-4 ring-3 ring-blue-100 shadow-md\",children:(user===null||user===void 0?void 0:(_user$first_name=user.first_name)===null||_user$first_name===void 0?void 0:_user$first_name.charAt(0))||(user===null||user===void 0?void 0:(_user$username=user.username)===null||_user$username===void 0?void 0:_user$username.charAt(0))||'U'}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white\"})]}),/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-1\",children:[user===null||user===void 0?void 0:user.first_name,\" \",user===null||user===void 0?void 0:user.last_name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-500 mb-4\",children:[\"@\",user===null||user===void 0?void 0:user.username]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xl font-bold text-blue-600\",children:\"12\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Posts\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xl font-bold text-green-600\",children:\"48\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Following\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xl font-bold text-purple-600\",children:\"124\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Followers\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFollowSearch(true),className:\"w-full bg-orange-600 text-white py-2.5 px-4 rounded-xl hover:bg-orange-700 transition-colors font-medium shadow-md\",children:\"Find People\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 relative overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-0 right-0 w-14 h-14 bg-green-50 rounded-full -translate-y-7 translate-x-7\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4 relative\",children:\"Today's Nutrition\"}),todayNutrition?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4 relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Calories\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold text-gray-900\",children:[todayNutrition.totalCalories||0,\" / \",todayNutrition.calorieGoal||2000]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-100 rounded-full h-2.5 shadow-inner\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-orange-500 h-2.5 rounded-full transition-all duration-300\",style:{width:\"\".concat(Math.min(100,(todayNutrition.totalCalories||0)/(todayNutrition.calorieGoal||2000)*100),\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center bg-green-50 rounded-xl p-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-green-600 font-semibold text-base\",children:[todayNutrition.totalProtein||0,\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500 text-xs\",children:\"Protein\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center bg-yellow-50 rounded-xl p-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-yellow-600 font-semibold text-base\",children:[todayNutrition.totalCarbs||0,\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500 text-xs\",children:\"Carbs\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center bg-red-50 rounded-xl p-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-red-600 font-semibold text-base\",children:[todayNutrition.totalFat||0,\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500 text-xs\",children:\"Fat\"})]})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-center py-6 relative\",children:\"No nutrition data for today\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 relative overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-0 left-0 w-16 h-16 bg-purple-50 rounded-full translate-y-8 -translate-x-8\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4 relative\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Calendar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentDate(subMonths(currentDate,1)),className:\"p-2 hover:bg-gray-100 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-4 h-4 text-gray-500\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentDate(addMonths(currentDate,1)),className:\"p-2 hover:bg-gray-100 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(ChevronRight,{className:\"w-4 h-4 text-gray-500\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-3 relative\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-900 bg-gray-50 rounded-lg py-2 px-3\",children:format(currentDate,'MMMM yyyy')})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-7 gap-1 text-xs relative\",children:[['S','M','T','W','T','F','S'].map(day=>/*#__PURE__*/_jsx(\"div\",{className:\"text-center p-2 text-gray-500 font-medium\",children:day},day)),eachDayOfInterval({start:startOfMonth(currentDate),end:endOfMonth(currentDate)}).map(day=>{var _monthData$days;const dayData=monthData===null||monthData===void 0?void 0:(_monthData$days=monthData.days)===null||_monthData$days===void 0?void 0:_monthData$days.find(d=>new Date(d.date).getDate()===day.getDate());const hasData=dayData===null||dayData===void 0?void 0:dayData.has_data;const isCurrentDay=isToday(day);return/*#__PURE__*/_jsx(\"div\",{className:\"\\n                        text-center p-2 rounded-lg text-sm font-medium transition-all duration-200\\n                        \".concat(isCurrentDay?'bg-orange-500 text-white shadow-md':'',\"\\n                        \").concat(hasData&&!isCurrentDay?'bg-green-100 text-green-700':'',\"\\n                        \").concat(!hasData&&!isCurrentDay?'text-gray-400 hover:bg-gray-50':'',\"\\n                      \"),children:day.getDate()},day.toISOString());})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 space-y-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreatePost(true),className:\"w-full bg-white border border-gray-200 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-orange-500 flex items-center justify-center text-white font-semibold\",children:(user===null||user===void 0?void 0:(_user$first_name2=user.first_name)===null||_user$first_name2===void 0?void 0:_user$first_name2.charAt(0))||(user===null||user===void 0?void 0:(_user$username2=user.username)===null||_user$username2===void 0?void 0:_user$username2.charAt(0))||'U'}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"What's on your mind?\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[posts.length===0&&!loading&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border border-gray-200 rounded-lg shadow-sm p-8 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(MessageCircle,{className:\"w-8 h-8 text-orange-500\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-2\",children:\"No posts yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:\"Your feed is empty. Start connecting with others to see their posts!\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row gap-3 justify-center\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFollowSearch(true),className:\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-medium\",children:\"Find Friends\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{/* Navigate to groups when implemented */},className:\"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium\",children:\"Browse Groups\"})]})]}),posts.map(post=>{var _post$user$first_name,_post$user$username,_user$first_name3,_user$username3,_newComments$post$id,_comments$post$id;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border border-gray-200 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 border-b border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-sm font-semibold\",children:((_post$user$first_name=post.user.first_name)===null||_post$user$first_name===void 0?void 0:_post$user$first_name.charAt(0))||((_post$user$username=post.user.username)===null||_post$user$username===void 0?void 0:_post$user$username.charAt(0))}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-gray-900\",children:[post.user.first_name,\" \",post.user.last_name]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:formatPostDate(post.created_at)})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(MoreHorizontal,{className:\"w-5 h-5\"})})]}),post.content&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:post.content})}),post.image_url&&/*#__PURE__*/_jsx(\"div\",{className:\"w-full\",children:/*#__PURE__*/_jsx(\"img\",{src:post.image_url,alt:\"Post\",className:\"w-full object-cover\"})}),post.meal_data&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-900 mb-2\",children:\"Meal Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-4 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-orange-600\",children:post.meal_data.calories||0}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600\",children:\"Calories\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-green-600\",children:[post.meal_data.protein||0,\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600\",children:\"Protein\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-yellow-600\",children:[post.meal_data.carbs||0,\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600\",children:\"Carbs\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-red-600\",children:[post.meal_data.fat||0,\"g\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600\",children:\"Fat\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3 border-t border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-6\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleLike(post.id),className:\"flex items-center space-x-2 \".concat(post.is_liked?'text-red-500':'text-gray-500 hover:text-red-500'),children:[/*#__PURE__*/_jsx(Heart,{className:\"w-5 h-5 \".concat(post.is_liked?'fill-current':'')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:post.likes_count})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>toggleComments(post.id),className:\"flex items-center space-x-2 text-gray-500 hover:text-orange-500\",children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:post.comments_count})]}),/*#__PURE__*/_jsx(\"button\",{className:\"text-gray-500 hover:text-orange-500\",children:/*#__PURE__*/_jsx(Share,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleBookmark(post.id),className:\"\".concat(post.is_bookmarked?'text-orange-500':'text-gray-500 hover:text-orange-500'),children:/*#__PURE__*/_jsx(Bookmark,{className:\"w-5 h-5 \".concat(post.is_bookmarked?'fill-current':'')})})]})}),expandedComments.has(post.id)&&/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-3 border-t border-gray-200 bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-sm font-semibold\",children:(user===null||user===void 0?void 0:(_user$first_name3=user.first_name)===null||_user$first_name3===void 0?void 0:_user$first_name3.charAt(0))||(user===null||user===void 0?void 0:(_user$username3=user.username)===null||_user$username3===void 0?void 0:_user$username3.charAt(0))||'U'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Add a comment...\",value:newComments[post.id]||'',onChange:e=>setNewComments(prev=>_objectSpread(_objectSpread({},prev),{},{[post.id]:e.target.value})),className:\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500\",onKeyPress:e=>e.key==='Enter'&&handleAddComment(post.id)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAddComment(post.id),disabled:!((_newComments$post$id=newComments[post.id])!==null&&_newComments$post$id!==void 0&&_newComments$post$id.trim()),className:\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Post\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:(_comments$post$id=comments[post.id])===null||_comments$post$id===void 0?void 0:_comments$post$id.map(comment=>{var _comment$user$first_n,_comment$user$usernam;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-sm font-semibold\",children:((_comment$user$first_n=comment.user.first_name)===null||_comment$user$first_n===void 0?void 0:_comment$user$first_n.charAt(0))||((_comment$user$usernam=comment.user.username)===null||_comment$user$usernam===void 0?void 0:_comment$user$usernam.charAt(0))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-sm text-gray-900\",children:[comment.user.first_name,\" \",comment.user.last_name]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-700\",children:comment.content})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mt-1\",children:formatDistanceToNow(new Date(comment.created_at),{addSuffix:true})})]})]},comment.id);})})]})]},post.id);})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-80 flex-shrink-0 sticky top-6 self-start space-y-6 max-h-[calc(100vh-3rem)] overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 relative overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-0 right-0 w-14 h-14 bg-indigo-50 rounded-full -translate-y-7 translate-x-7\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6 relative\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Groups\"}),/*#__PURE__*/_jsx(\"button\",{className:\"text-blue-600 hover:text-blue-700 text-sm font-medium bg-blue-50 hover:bg-blue-100 px-3 py-1 rounded-full transition-colors\",children:\"See All\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-xl bg-green-500 flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-semibold text-sm\",children:\"VG\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900 group-hover:text-green-600 transition-colors\",children:\"Vegan Recipes\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"1.2k members\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-xl bg-blue-500 flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-semibold text-sm\",children:\"FT\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900 group-hover:text-blue-600 transition-colors\",children:\"Fitness Goals\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"856 members\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-xl bg-purple-500 flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-semibold text-sm\",children:\"WL\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900 group-hover:text-purple-600 transition-colors\",children:\"Weight Loss\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"2.1k members\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-xl bg-orange-500 flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-semibold text-sm\",children:\"KT\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-900 group-hover:text-orange-600 transition-colors\",children:\"Keto Diet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"643 members\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"w-full mt-6 bg-orange-600 text-white py-2.5 px-4 rounded-xl hover:bg-orange-700 transition-colors font-medium shadow-md\",children:\"Create Group\"})]})})]})}),showCreatePost&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900\",children:\"Create Post\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreatePost(false),className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-orange-500 flex items-center justify-center text-white font-semibold\",children:(user===null||user===void 0?void 0:(_user$first_name4=user.first_name)===null||_user$first_name4===void 0?void 0:_user$first_name4.charAt(0))||(user===null||user===void 0?void 0:(_user$username4=user.username)===null||_user$username4===void 0?void 0:_user$username4.charAt(0))||'U'}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"What's on your mind?\",value:newPost.content,onChange:e=>setNewPost(prev=>_objectSpread(_objectSpread({},prev),{},{content:e.target.value})),className:\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none\",rows:4})})]}),newPost.imageFile&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(newPost.imageFile),alt:\"Preview\",className:\"w-full h-64 object-cover rounded-lg\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setNewPost(prev=>_objectSpread(_objectSpread({},prev),{},{imageFile:null})),className:\"absolute top-2 right-2 bg-black bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-70\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Post Settings\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:newPost.allowComments,onChange:e=>setNewPost(prev=>_objectSpread(_objectSpread({},prev),{},{allowComments:e.target.checked})),className:\"rounded border-gray-300 text-orange-600 focus:ring-orange-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-700\",children:\"Allow comments\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:newPost.hideLikeCount,onChange:e=>setNewPost(prev=>_objectSpread(_objectSpread({},prev),{},{hideLikeCount:e.target.checked})),className:\"rounded border-gray-300 text-orange-600 focus:ring-orange-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-700\",children:\"Hide like count\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-4\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-gray-600 hover:text-orange-600 cursor-pointer\",children:[/*#__PURE__*/_jsx(Image,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Photo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleImageUpload,className:\"hidden\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreatePost(false),className:\"px-4 py-2 text-gray-600 hover:text-gray-800\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCreatePost,disabled:!newPost.content.trim()&&!newPost.imageFile,className:\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Post\"})]})]})]})]})}),showFollowSearch&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-6 border-b border-gray-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900\",children:\"Find People\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFollowSearch(false),className:\"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-full transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for people...\",value:searchQuery,onChange:e=>{setSearchQuery(e.target.value);searchUsers(e.target.value);},className:\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"})}),searchLoading?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center py-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:searchResults.map(user=>{var _user$first_name5,_user$username5;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 hover:bg-gray-50 rounded-xl transition-colors\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold\",children:((_user$first_name5=user.first_name)===null||_user$first_name5===void 0?void 0:_user$first_name5.charAt(0))||((_user$username5=user.username)===null||_user$username5===void 0?void 0:_user$username5.charAt(0))}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium text-gray-900\",children:[user.first_name,\" \",user.last_name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[\"@\",user.username]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleFollow(user.id),className:\"px-4 py-2 rounded-xl font-medium transition-colors \".concat(user.is_following?'bg-gray-200 text-gray-700 hover:bg-gray-300':'bg-blue-600 text-white hover:bg-blue-700'),children:user.is_following?'Following':'Follow'})]},user.id);})})]})]})})]});};export default Feed;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useAuth","Heart","MessageCircle","Share","MoreHorizontal","Bookmark","Image","X","ChevronLeft","ChevronRight","formatDistanceToNow","format","startOfMonth","endOfMonth","eachDayOfInterval","isToday","addMonths","subMonths","useNavigate","diaryAPI","mealsAPI","profileAPI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Feed","_user$first_name","_user$username","_user$first_name2","_user$username2","_user$first_name4","_user$username4","user","navigate","posts","setPosts","loading","setLoading","showCreatePost","setShowCreatePost","newPost","setNewPost","content","imageFile","mealData","allowComments","hideLikeCount","expandedComments","setExpandedComments","Set","comments","setComments","newComments","setNewComments","loadingComments","setLoadingComments","profileData","setProfileData","todayNutrition","setTodayNutrition","currentDate","setCurrentDate","Date","monthData","setMonthData","sidebarLoading","setSidebarLoading","showFollowSearch","setShowFollowSearch","searchQuery","setSearchQuery","searchResults","setSearchResults","searchLoading","setSearchLoading","formatPostDate","dateString","postDate","today","toDateString","concat","toLocaleTimeString","hour","minute","hour12","addSuffix","loadMonthData","_response$data$days","_response$data$days$f","year","getFullYear","month","getMonth","console","log","response","data","days","filter","d","has_data","length","error","loadSidebarData","profileResponse","get","profile","toISOString","split","mealsResponse","getByDate","_profileResponse$data","_profileResponse$data2","meals","totalCalories","reduce","sum","meal","calories","totalProtein","protein","totalCarbs","carbs","totalFat","fat","nutritionData","calorieGoal","daily_calories","proteinGoal","daily_protein","loadPosts","fetch","headers","localStorage","getItem","ok","json","handleLike","postId","method","map","post","id","_objectSpread","is_liked","likes_count","handleBookmark","is_bookmarked","toggleComments","has","prev","newSet","delete","add","handleAddComment","_newComments$postId","trim","body","JSON","stringify","newComment","comments_count","handleCreatePost","formData","FormData","append","toString","newPostData","handleImageUpload","event","_event$target$files","file","target","files","searchUsers","query","encodeURIComponent","handleFollow","userId","is_following","className","children","profile_picture","src","alt","first_name","charAt","username","last_name","onClick","style","width","Math","min","day","start","end","_monthData$days","dayData","find","date","getDate","hasData","isCurrentDay","_post$user$first_name","_post$user$username","_user$first_name3","_user$username3","_newComments$post$id","_comments$post$id","created_at","image_url","meal_data","type","placeholder","value","onChange","e","onKeyPress","key","disabled","comment","_comment$user$first_n","_comment$user$usernam","rows","URL","createObjectURL","checked","accept","_user$first_name5","_user$username5"],"sources":["C:/Users/arian/OneDrive/Desktop/Nutrition/client/src/components/Feed.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { Heart, MessageCircle, Share, MoreHorizontal, PenTool, Bookmark, Image, X, Plus, UserCircle, Calendar, TrendingUp, TrendingDown, BarChart3, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport { formatDistanceToNow, format, startOfMonth, endOfMonth, eachDayOfInterval, isSameMonth, isToday, addMonths, subMonths } from 'date-fns';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { diaryAPI, mealsAPI, profileAPI } from '../services/api';\r\n\r\ninterface Post {\r\n  id: number;\r\n  content: string;\r\n  image_url: string | null;\r\n  meal_data: any;\r\n  likes_count: number;\r\n  comments_count: number;\r\n  is_liked: boolean;\r\n  is_bookmarked: boolean;\r\n  allow_comments?: boolean;\r\n  hide_like_count?: boolean;\r\n  created_at: string;\r\n  user: {\r\n    id: number;\r\n    username: string;\r\n    first_name: string;\r\n    last_name: string;\r\n    profile_picture?: string;\r\n  };\r\n}\r\n\r\ninterface Comment {\r\n  id: number;\r\n  content: string;\r\n  created_at: string;\r\n  user: {\r\n    id: number;\r\n    username: string;\r\n    first_name: string;\r\n    last_name: string;\r\n    profile_picture?: string;\r\n  };\r\n}\r\n\r\nconst Feed: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [posts, setPosts] = useState<Post[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreatePost, setShowCreatePost] = useState(false);\r\n  const [newPost, setNewPost] = useState({ \r\n    content: '', \r\n    imageFile: null as File | null, \r\n    mealData: null,\r\n    allowComments: true,\r\n    hideLikeCount: false\r\n  });\r\n  const [expandedComments, setExpandedComments] = useState<Set<number>>(new Set());\r\n  const [comments, setComments] = useState<{ [postId: number]: Comment[] }>({});\r\n  const [newComments, setNewComments] = useState<{ [postId: number]: string }>({});\r\n  const [loadingComments, setLoadingComments] = useState<Set<number>>(new Set());\r\n  \r\n  // Sidebar data states\r\n  const [profileData, setProfileData] = useState<any>(null);\r\n  const [todayNutrition, setTodayNutrition] = useState<any>(null);\r\n  const [currentDate, setCurrentDate] = useState(new Date());\r\n  const [monthData, setMonthData] = useState<any>(null);\r\n  const [sidebarLoading, setSidebarLoading] = useState(true);\r\n  \r\n  // Follow people search states\r\n  const [showFollowSearch, setShowFollowSearch] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState<any[]>([]);\r\n  const [searchLoading, setSearchLoading] = useState(false);\r\n\r\n  const formatPostDate = (dateString: string) => {\r\n    const postDate = new Date(dateString);\r\n    const today = new Date();\r\n    const isToday = postDate.toDateString() === today.toDateString();\r\n    \r\n    if (isToday) {\r\n      return `Today at ${postDate.toLocaleTimeString('en-US', { \r\n        hour: 'numeric', \r\n        minute: '2-digit', \r\n        hour12: true \r\n      })}`;\r\n    } else {\r\n      return formatDistanceToNow(postDate, { addSuffix: true });\r\n    }\r\n  };\r\n\r\n  const loadMonthData = useCallback(async () => {\r\n    try {\r\n      const year = currentDate.getFullYear();\r\n      const month = currentDate.getMonth() + 1;\r\n      \r\n      console.log('ðŸ“… Feed Calendar: Loading month data for:', { year, month });\r\n      \r\n      // Use the EXACT same API call as Diary component\r\n      const response = await diaryAPI.getMonth(year, month);\r\n      \r\n      console.log('ðŸ“… Feed Calendar: Response received:', response.data);\r\n      console.log('ðŸ“… Feed Calendar: Days with data:', response.data.days?.filter((d: any) => d.has_data)?.length || 0);\r\n      \r\n      setMonthData(response.data);\r\n    } catch (error) {\r\n      console.error('ðŸ“… Feed Calendar: Error loading month data:', error);\r\n      setMonthData({ days: [] });\r\n    }\r\n  }, [currentDate]);\r\n\r\n  const loadSidebarData = useCallback(async () => {\r\n    if (!user) return;\r\n    \r\n    setSidebarLoading(true);\r\n    try {\r\n      console.log('ðŸ“Š Feed: Loading sidebar data...');\r\n      \r\n      // Load profile data using the same API as Overview\r\n      const profileResponse = await profileAPI.get();\r\n      if (profileResponse.data.profile) {\r\n        setProfileData(profileResponse.data);\r\n        console.log('ðŸ“Š Feed: Profile data loaded:', profileResponse.data.profile);\r\n      }\r\n\r\n      // Load today's nutrition using the same method as Overview\r\n      const today = new Date().toISOString().split('T')[0];\r\n      const mealsResponse = await mealsAPI.getByDate(today);\r\n      console.log('ðŸ“Š Feed: Meals response:', mealsResponse.data);\r\n      \r\n      if (mealsResponse.data) {\r\n        // Calculate totals from meals (same as Overview)\r\n        const meals = mealsResponse.data.meals || [];\r\n        const totalCalories = meals.reduce((sum: number, meal: any) => sum + (meal.calories || 0), 0);\r\n        const totalProtein = meals.reduce((sum: number, meal: any) => sum + (meal.protein || 0), 0);\r\n        const totalCarbs = meals.reduce((sum: number, meal: any) => sum + (meal.carbs || 0), 0);\r\n        const totalFat = meals.reduce((sum: number, meal: any) => sum + (meal.fat || 0), 0);\r\n        \r\n        // Create nutrition data object (same structure as Overview)\r\n        const nutritionData = {\r\n          totalCalories: totalCalories,\r\n          totalProtein: totalProtein,\r\n          totalCarbs: totalCarbs,\r\n          totalFat: totalFat,\r\n          calorieGoal: profileResponse.data.profile?.daily_calories || 2000,\r\n          proteinGoal: profileResponse.data.profile?.daily_protein || 150,\r\n        };\r\n        \r\n        console.log('ðŸ“Š Feed: Calculated nutrition data:', nutritionData);\r\n        setTodayNutrition(nutritionData);\r\n      }\r\n\r\n      // Load month data for calendar\r\n      await loadMonthData();\r\n      \r\n    } catch (error) {\r\n      console.error('ðŸ“Š Feed: Error loading sidebar data:', error);\r\n    } finally {\r\n      setSidebarLoading(false);\r\n    }\r\n  }, [user, loadMonthData]);\r\n\r\n  const loadPosts = async () => {\r\n    try {\r\n      const response = await fetch('/api/social/feed', {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('nutritrack_auth_data')}`\r\n        }\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setPosts(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading posts:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLike = async (postId: number) => {\r\n    try {\r\n      const response = await fetch(`/api/social/posts/${postId}/like`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('nutritrack_auth_data')}`\r\n        }\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setPosts(posts.map(post => \r\n          post.id === postId \r\n            ? { ...post, is_liked: data.is_liked, likes_count: data.likes_count }\r\n            : post\r\n        ));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error liking post:', error);\r\n    }\r\n  };\r\n\r\n  const handleBookmark = async (postId: number) => {\r\n    try {\r\n      const response = await fetch(`/api/social/posts/${postId}/bookmark`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('nutritrack_auth_data')}`\r\n        }\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setPosts(posts.map(post => \r\n          post.id === postId \r\n            ? { ...post, is_bookmarked: data.is_bookmarked }\r\n            : post\r\n        ));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error bookmarking post:', error);\r\n    }\r\n  };\r\n\r\n  const toggleComments = async (postId: number) => {\r\n    if (expandedComments.has(postId)) {\r\n      setExpandedComments(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.delete(postId);\r\n        return newSet;\r\n      });\r\n    } else {\r\n      setExpandedComments(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.add(postId);\r\n        return newSet;\r\n      });\r\n      \r\n      if (!comments[postId]) {\r\n        setLoadingComments(prev => {\r\n          const newSet = new Set(prev);\r\n          newSet.add(postId);\r\n          return newSet;\r\n        });\r\n        \r\n        try {\r\n          const response = await fetch(`/api/social/posts/${postId}/comments`, {\r\n            headers: {\r\n              'Authorization': `Bearer ${localStorage.getItem('nutritrack_auth_data')}`\r\n            }\r\n          });\r\n          \r\n          if (response.ok) {\r\n            const data = await response.json();\r\n            setComments(prev => ({ ...prev, [postId]: data }));\r\n          }\r\n        } catch (error) {\r\n          console.error('Error loading comments:', error);\r\n        } finally {\r\n          setLoadingComments(prev => {\r\n            const newSet = new Set(prev);\r\n            newSet.delete(postId);\r\n            return newSet;\r\n          });\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleAddComment = async (postId: number) => {\r\n    const content = newComments[postId]?.trim();\r\n    if (!content) return;\r\n\r\n    try {\r\n      const response = await fetch(`/api/social/posts/${postId}/comments`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${localStorage.getItem('nutritrack_auth_data')}`\r\n        },\r\n        body: JSON.stringify({ content })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const newComment = await response.json();\r\n        setComments(prev => ({\r\n          ...prev,\r\n          [postId]: [...(prev[postId] || []), newComment]\r\n        }));\r\n        setNewComments(prev => ({ ...prev, [postId]: '' }));\r\n        \r\n        setPosts(posts.map(post => \r\n          post.id === postId \r\n            ? { ...post, comments_count: post.comments_count + 1 }\r\n            : post\r\n        ));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding comment:', error);\r\n    }\r\n  };\r\n\r\n  const handleCreatePost = async () => {\r\n    if (!newPost.content.trim() && !newPost.imageFile) return;\r\n\r\n    const formData = new FormData();\r\n    formData.append('content', newPost.content);\r\n    if (newPost.imageFile) {\r\n      formData.append('image', newPost.imageFile);\r\n    }\r\n    if (newPost.mealData) {\r\n      formData.append('meal_data', JSON.stringify(newPost.mealData));\r\n    }\r\n    formData.append('allow_comments', newPost.allowComments.toString());\r\n    formData.append('hide_like_count', newPost.hideLikeCount.toString());\r\n\r\n    try {\r\n      const response = await fetch('/api/social/posts', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('nutritrack_auth_data')}`\r\n        },\r\n        body: formData\r\n      });\r\n\r\n      if (response.ok) {\r\n        const newPostData = await response.json();\r\n        setPosts([newPostData, ...posts]);\r\n        setNewPost({\r\n          content: '',\r\n          imageFile: null,\r\n          mealData: null,\r\n          allowComments: true,\r\n          hideLikeCount: false\r\n        });\r\n        setShowCreatePost(false);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error creating post:', error);\r\n    }\r\n  };\r\n\r\n  const handleImageUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      setNewPost(prev => ({ ...prev, imageFile: file }));\r\n    }\r\n  };\r\n\r\n  const searchUsers = async (query: string) => {\r\n    if (!query.trim()) {\r\n      setSearchResults([]);\r\n      return;\r\n    }\r\n\r\n    setSearchLoading(true);\r\n    try {\r\n      const response = await fetch(`/api/social/users/search?q=${encodeURIComponent(query)}`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('nutritrack_auth_data')}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setSearchResults(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error searching users:', error);\r\n    } finally {\r\n      setSearchLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFollow = async (userId: number) => {\r\n    try {\r\n      const response = await fetch(`/api/social/users/${userId}/follow`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('nutritrack_auth_data')}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        setSearchResults(searchResults.map(user =>\r\n          user.id === userId\r\n            ? { ...user, is_following: !user.is_following }\r\n            : user\r\n        ));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error following user:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      loadPosts();\r\n      loadSidebarData();\r\n    }\r\n  }, [user, loadSidebarData]);\r\n\r\n  useEffect(() => {\r\n    loadMonthData();\r\n  }, [loadMonthData]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"min-h-screen bg-gray-50\">\r\n        \r\n        {/* Three Column Layout */}\r\n        <div className=\"flex gap-6 max-w-7xl mx-auto p-6\">\r\n          \r\n          {/* Left Sidebar - Profile & Calendar */}\r\n          <div className=\"w-80 flex-shrink-0 sticky top-6 self-start space-y-6 max-h-[calc(100vh-3rem)] overflow-y-auto\">\r\n            \r\n            {/* Profile Card */}\r\n            <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 relative overflow-hidden\">\r\n              {/* Subtle decorative elements */}\r\n              <div className=\"absolute top-0 right-0 w-16 h-16 bg-blue-50 rounded-full -translate-y-8 translate-x-8\"></div>\r\n              <div className=\"absolute bottom-0 left-0 w-12 h-12 bg-purple-50 rounded-full translate-y-6 -translate-x-6\"></div>\r\n              \r\n              <div className=\"relative text-center\">\r\n                {user?.profile_picture ? (\r\n                  <div className=\"relative inline-block\">\r\n                    <img \r\n                      src={user.profile_picture} \r\n                      alt=\"Profile\" \r\n                      className=\"w-20 h-20 rounded-full mx-auto mb-4 object-cover ring-3 ring-blue-100 shadow-md\"\r\n                    />\r\n                    <div className=\"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white\"></div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"relative inline-block\">\r\n                    <div className=\"w-20 h-20 rounded-full bg-blue-500 flex items-center justify-center text-white text-xl font-semibold mx-auto mb-4 ring-3 ring-blue-100 shadow-md\">\r\n                      {user?.first_name?.charAt(0) || user?.username?.charAt(0) || 'U'}\r\n                    </div>\r\n                    <div className=\"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white\"></div>\r\n                  </div>\r\n                )}\r\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-1\">\r\n                  {user?.first_name} {user?.last_name}\r\n                </h3>\r\n                <p className=\"text-gray-500 mb-4\">@{user?.username}</p>\r\n                \r\n                {/* Stats */}\r\n                <div className=\"grid grid-cols-3 gap-4 mb-6\">\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-xl font-bold text-blue-600\">12</div>\r\n                    <div className=\"text-xs text-gray-500\">Posts</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-xl font-bold text-green-600\">48</div>\r\n                    <div className=\"text-xs text-gray-500\">Following</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-xl font-bold text-purple-600\">124</div>\r\n                    <div className=\"text-xs text-gray-500\">Followers</div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <button \r\n                  onClick={() => setShowFollowSearch(true)}\r\n                  className=\"w-full bg-orange-600 text-white py-2.5 px-4 rounded-xl hover:bg-orange-700 transition-colors font-medium shadow-md\"\r\n                >\r\n                  Find People\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Today's Nutrition Card */}\r\n            <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 relative overflow-hidden\">\r\n              <div className=\"absolute top-0 right-0 w-14 h-14 bg-green-50 rounded-full -translate-y-7 translate-x-7\"></div>\r\n              \r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4 relative\">Today's Nutrition</h3>\r\n              {todayNutrition ? (\r\n                <div className=\"space-y-4 relative\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <span className=\"text-gray-600\">Calories</span>\r\n                    <span className=\"font-semibold text-gray-900\">\r\n                      {todayNutrition.totalCalories || 0} / {todayNutrition.calorieGoal || 2000}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"w-full bg-gray-100 rounded-full h-2.5 shadow-inner\">\r\n                    <div \r\n                      className=\"bg-orange-500 h-2.5 rounded-full transition-all duration-300\" \r\n                      style={{ \r\n                        width: `${Math.min(100, ((todayNutrition.totalCalories || 0) / (todayNutrition.calorieGoal || 2000)) * 100)}%` \r\n                      }}\r\n                    ></div>\r\n                  </div>\r\n                  \r\n                  {/* Macros */}\r\n                  <div className=\"grid grid-cols-3 gap-3\">\r\n                    <div className=\"text-center bg-green-50 rounded-xl p-3\">\r\n                      <div className=\"text-green-600 font-semibold text-base\">{todayNutrition.totalProtein || 0}g</div>\r\n                      <div className=\"text-gray-500 text-xs\">Protein</div>\r\n                    </div>\r\n                    <div className=\"text-center bg-yellow-50 rounded-xl p-3\">\r\n                      <div className=\"text-yellow-600 font-semibold text-base\">{todayNutrition.totalCarbs || 0}g</div>\r\n                      <div className=\"text-gray-500 text-xs\">Carbs</div>\r\n                    </div>\r\n                    <div className=\"text-center bg-red-50 rounded-xl p-3\">\r\n                      <div className=\"text-red-600 font-semibold text-base\">{todayNutrition.totalFat || 0}g</div>\r\n                      <div className=\"text-gray-500 text-xs\">Fat</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"text-gray-400 text-center py-6 relative\">No nutrition data for today</div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Calendar Streak Card */}\r\n            <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 relative overflow-hidden\">\r\n              <div className=\"absolute bottom-0 left-0 w-16 h-16 bg-purple-50 rounded-full translate-y-8 -translate-x-8\"></div>\r\n              \r\n              <div className=\"flex items-center justify-between mb-4 relative\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Calendar</h3>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <button \r\n                    onClick={() => setCurrentDate(subMonths(currentDate, 1))}\r\n                    className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\r\n                  >\r\n                    <ChevronLeft className=\"w-4 h-4 text-gray-500\" />\r\n                  </button>\r\n                  <button \r\n                    onClick={() => setCurrentDate(addMonths(currentDate, 1))}\r\n                    className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\r\n                  >\r\n                    <ChevronRight className=\"w-4 h-4 text-gray-500\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-center mb-3 relative\">\r\n                <div className=\"text-sm font-medium text-gray-900 bg-gray-50 rounded-lg py-2 px-3\">\r\n                  {format(currentDate, 'MMMM yyyy')}\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Calendar Grid */}\r\n              <div className=\"grid grid-cols-7 gap-1 text-xs relative\">\r\n                {['S', 'M', 'T', 'W', 'T', 'F', 'S'].map(day => (\r\n                  <div key={day} className=\"text-center p-2 text-gray-500 font-medium\">\r\n                    {day}\r\n                  </div>\r\n                ))}\r\n                {eachDayOfInterval({\r\n                  start: startOfMonth(currentDate),\r\n                  end: endOfMonth(currentDate)\r\n                }).map(day => {\r\n                  const dayData = monthData?.days?.find((d: any) => \r\n                    new Date(d.date).getDate() === day.getDate()\r\n                  );\r\n                  const hasData = dayData?.has_data;\r\n                  const isCurrentDay = isToday(day);\r\n                  \r\n                  return (\r\n                    <div\r\n                      key={day.toISOString()}\r\n                      className={`\r\n                        text-center p-2 rounded-lg text-sm font-medium transition-all duration-200\r\n                        ${isCurrentDay ? 'bg-orange-500 text-white shadow-md' : ''}\r\n                        ${hasData && !isCurrentDay ? 'bg-green-100 text-green-700' : ''}\r\n                        ${!hasData && !isCurrentDay ? 'text-gray-400 hover:bg-gray-50' : ''}\r\n                      `}\r\n                    >\r\n                      {day.getDate()}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Main Feed Content */}\r\n          <div className=\"flex-1 space-y-6\">\r\n            {/* Create Post Button - Simple */}\r\n            <button\r\n              onClick={() => setShowCreatePost(true)}\r\n              className=\"w-full bg-white border border-gray-200 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors shadow-sm\"\r\n            >\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"w-10 h-10 rounded-full bg-orange-500 flex items-center justify-center text-white font-semibold\">\r\n                  {user?.first_name?.charAt(0) || user?.username?.charAt(0) || 'U'}\r\n                </div>\r\n                <span className=\"text-gray-600\">What's on your mind?</span>\r\n              </div>\r\n            </button>\r\n\r\n            {/* Posts - Original Simple Design */}\r\n            <div className=\"space-y-6\">\r\n              {posts.length === 0 && !loading && (\r\n                <div className=\"bg-white border border-gray-200 rounded-lg shadow-sm p-8 text-center\">\r\n                  <div className=\"mb-4\">\r\n                    <div className=\"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                      <MessageCircle className=\"w-8 h-8 text-orange-500\" />\r\n                    </div>\r\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">No posts yet</h3>\r\n                    <p className=\"text-gray-600 mb-6\">Your feed is empty. Start connecting with others to see their posts!</p>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex flex-col sm:flex-row gap-3 justify-center\">\r\n                    <button\r\n                      onClick={() => setShowFollowSearch(true)}\r\n                      className=\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-medium\"\r\n                    >\r\n                      Find Friends\r\n                    </button>\r\n                    <button\r\n                      onClick={() => {/* Navigate to groups when implemented */}}\r\n                      className=\"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium\"\r\n                    >\r\n                      Browse Groups\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {posts.map(post => (\r\n                <div key={post.id} className=\"bg-white border border-gray-200 rounded-lg shadow-sm\">\r\n                  {/* Post Header */}\r\n                  <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-sm font-semibold\">\r\n                        {post.user.first_name?.charAt(0) || post.user.username?.charAt(0)}\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-semibold text-gray-900\">{post.user.first_name} {post.user.last_name}</div>\r\n                        <div className=\"text-sm text-gray-500\">{formatPostDate(post.created_at)}</div>\r\n                      </div>\r\n                    </div>\r\n                    <button className=\"text-gray-400 hover:text-gray-600\">\r\n                      <MoreHorizontal className=\"w-5 h-5\" />\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Post Content */}\r\n                  {post.content && (\r\n                    <div className=\"p-4\">\r\n                      <p className=\"text-gray-900\">{post.content}</p>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Post Image */}\r\n                  {post.image_url && (\r\n                    <div className=\"w-full\">\r\n                      <img \r\n                        src={post.image_url} \r\n                        alt=\"Post\" \r\n                        className=\"w-full object-cover\"\r\n                      />\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Meal Data */}\r\n                  {post.meal_data && (\r\n                    <div className=\"p-4 bg-gray-50 border-t border-gray-200\">\r\n                      <div className=\"text-sm font-medium text-gray-900 mb-2\">Meal Information</div>\r\n                      <div className=\"grid grid-cols-4 gap-4 text-sm\">\r\n                        <div className=\"text-center\">\r\n                          <div className=\"font-semibold text-orange-600\">{post.meal_data.calories || 0}</div>\r\n                          <div className=\"text-gray-600\">Calories</div>\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                          <div className=\"font-semibold text-green-600\">{post.meal_data.protein || 0}g</div>\r\n                          <div className=\"text-gray-600\">Protein</div>\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                          <div className=\"font-semibold text-yellow-600\">{post.meal_data.carbs || 0}g</div>\r\n                          <div className=\"text-gray-600\">Carbs</div>\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                          <div className=\"font-semibold text-red-600\">{post.meal_data.fat || 0}g</div>\r\n                          <div className=\"text-gray-600\">Fat</div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Post Actions */}\r\n                  <div className=\"px-4 py-3 border-t border-gray-200\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center space-x-6\">\r\n                        <button\r\n                          onClick={() => handleLike(post.id)}\r\n                          className={`flex items-center space-x-2 ${post.is_liked ? 'text-red-500' : 'text-gray-500 hover:text-red-500'}`}\r\n                        >\r\n                          <Heart className={`w-5 h-5 ${post.is_liked ? 'fill-current' : ''}`} />\r\n                          <span className=\"text-sm\">{post.likes_count}</span>\r\n                        </button>\r\n                        <button\r\n                          onClick={() => toggleComments(post.id)}\r\n                          className=\"flex items-center space-x-2 text-gray-500 hover:text-orange-500\"\r\n                        >\r\n                          <MessageCircle className=\"w-5 h-5\" />\r\n                          <span className=\"text-sm\">{post.comments_count}</span>\r\n                        </button>\r\n                        <button className=\"text-gray-500 hover:text-orange-500\">\r\n                          <Share className=\"w-5 h-5\" />\r\n                        </button>\r\n                      </div>\r\n                      <button\r\n                        onClick={() => handleBookmark(post.id)}\r\n                        className={`${post.is_bookmarked ? 'text-orange-500' : 'text-gray-500 hover:text-orange-500'}`}\r\n                      >\r\n                        <Bookmark className={`w-5 h-5 ${post.is_bookmarked ? 'fill-current' : ''}`} />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Comments Section */}\r\n                  {expandedComments.has(post.id) && (\r\n                    <div className=\"px-4 py-3 border-t border-gray-200 bg-gray-50\">\r\n                      {/* Add Comment */}\r\n                      <div className=\"flex items-center space-x-3 mb-4\">\r\n                        <div className=\"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-sm font-semibold\">\r\n                          {user?.first_name?.charAt(0) || user?.username?.charAt(0) || 'U'}\r\n                        </div>\r\n                        <div className=\"flex-1 flex items-center space-x-2\">\r\n                          <input\r\n                            type=\"text\"\r\n                            placeholder=\"Add a comment...\"\r\n                            value={newComments[post.id] || ''}\r\n                            onChange={(e) => setNewComments(prev => ({...prev, [post.id]: e.target.value}))}\r\n                            className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500\"\r\n                            onKeyPress={(e) => e.key === 'Enter' && handleAddComment(post.id)}\r\n                          />\r\n                          <button\r\n                            onClick={() => handleAddComment(post.id)}\r\n                            disabled={!newComments[post.id]?.trim()}\r\n                            className=\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                          >\r\n                            Post\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Comments List */}\r\n                      <div className=\"space-y-3\">\r\n                        {comments[post.id]?.map(comment => (\r\n                          <div key={comment.id} className=\"flex items-start space-x-3\">\r\n                            <div className=\"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-sm font-semibold\">\r\n                              {comment.user.first_name?.charAt(0) || comment.user.username?.charAt(0)}\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                              <div className=\"bg-white rounded-lg p-3\">\r\n                                <div className=\"font-semibold text-sm text-gray-900\">{comment.user.first_name} {comment.user.last_name}</div>\r\n                                <div className=\"text-gray-700\">{comment.content}</div>\r\n                              </div>\r\n                              <div className=\"text-xs text-gray-500 mt-1\">{formatDistanceToNow(new Date(comment.created_at), { addSuffix: true })}</div>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Right Sidebar - Groups */}\r\n          <div className=\"w-80 flex-shrink-0 sticky top-6 self-start space-y-6 max-h-[calc(100vh-3rem)] overflow-y-auto\">\r\n            \r\n            {/* Groups Card */}\r\n            <div className=\"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 relative overflow-hidden\">\r\n              <div className=\"absolute top-0 right-0 w-14 h-14 bg-indigo-50 rounded-full -translate-y-7 translate-x-7\"></div>\r\n              \r\n              <div className=\"flex items-center justify-between mb-6 relative\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Groups</h3>\r\n                <button className=\"text-blue-600 hover:text-blue-700 text-sm font-medium bg-blue-50 hover:bg-blue-100 px-3 py-1 rounded-full transition-colors\">\r\n                  See All\r\n                </button>\r\n              </div>\r\n              \r\n              <div className=\"space-y-3 relative\">\r\n                {/* Mock Group Items */}\r\n                <div className=\"flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors group\">\r\n                  <div className=\"w-10 h-10 rounded-xl bg-green-500 flex items-center justify-center shadow-sm\">\r\n                    <span className=\"text-white font-semibold text-sm\">VG</span>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-medium text-gray-900 group-hover:text-green-600 transition-colors\">Vegan Recipes</div>\r\n                    <div className=\"text-sm text-gray-500\">1.2k members</div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors group\">\r\n                  <div className=\"w-10 h-10 rounded-xl bg-blue-500 flex items-center justify-center shadow-sm\">\r\n                    <span className=\"text-white font-semibold text-sm\">FT</span>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-medium text-gray-900 group-hover:text-blue-600 transition-colors\">Fitness Goals</div>\r\n                    <div className=\"text-sm text-gray-500\">856 members</div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors group\">\r\n                  <div className=\"w-10 h-10 rounded-xl bg-purple-500 flex items-center justify-center shadow-sm\">\r\n                    <span className=\"text-white font-semibold text-sm\">WL</span>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-medium text-gray-900 group-hover:text-purple-600 transition-colors\">Weight Loss</div>\r\n                    <div className=\"text-sm text-gray-500\">2.1k members</div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors group\">\r\n                  <div className=\"w-10 h-10 rounded-xl bg-orange-500 flex items-center justify-center shadow-sm\">\r\n                    <span className=\"text-white font-semibold text-sm\">KT</span>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"font-medium text-gray-900 group-hover:text-orange-600 transition-colors\">Keto Diet</div>\r\n                    <div className=\"text-sm text-gray-500\">643 members</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <button className=\"w-full mt-6 bg-orange-600 text-white py-2.5 px-4 rounded-xl hover:bg-orange-700 transition-colors font-medium shadow-md\">\r\n                Create Group\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Create Post Modal - Original Design */}\r\n      {showCreatePost && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\r\n              <h2 className=\"text-lg font-semibold text-gray-900\">Create Post</h2>\r\n              <button\r\n                onClick={() => setShowCreatePost(false)}\r\n                className=\"text-gray-400 hover:text-gray-600\"\r\n              >\r\n                <X className=\"w-5 h-5\" />\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"p-4 space-y-4\">\r\n              <div className=\"flex items-start space-x-3\">\r\n                <div className=\"w-10 h-10 rounded-full bg-orange-500 flex items-center justify-center text-white font-semibold\">\r\n                  {user?.first_name?.charAt(0) || user?.username?.charAt(0) || 'U'}\r\n                </div>\r\n                <div className=\"flex-1\">\r\n                  <textarea\r\n                    placeholder=\"What's on your mind?\"\r\n                    value={newPost.content}\r\n                    onChange={(e) => setNewPost(prev => ({ ...prev, content: e.target.value }))}\r\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none\"\r\n                    rows={4}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {newPost.imageFile && (\r\n                <div className=\"relative\">\r\n                  <img\r\n                    src={URL.createObjectURL(newPost.imageFile)}\r\n                    alt=\"Preview\"\r\n                    className=\"w-full h-64 object-cover rounded-lg\"\r\n                  />\r\n                  <button\r\n                    onClick={() => setNewPost(prev => ({ ...prev, imageFile: null }))}\r\n                    className=\"absolute top-2 right-2 bg-black bg-opacity-50 text-white p-1 rounded-full hover:bg-opacity-70\"\r\n                  >\r\n                    <X className=\"w-4 h-4\" />\r\n                  </button>\r\n                </div>\r\n              )}\r\n\r\n              {/* Post Options */}\r\n              <div className=\"space-y-3 pt-4 border-t border-gray-200\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-sm font-medium text-gray-700\">Post Settings</span>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center justify-between\">\r\n                  <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={newPost.allowComments}\r\n                      onChange={(e) => setNewPost(prev => ({ ...prev, allowComments: e.target.checked }))}\r\n                      className=\"rounded border-gray-300 text-orange-600 focus:ring-orange-500\"\r\n                    />\r\n                    <span className=\"text-sm text-gray-700\">Allow comments</span>\r\n                  </label>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center justify-between\">\r\n                  <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={newPost.hideLikeCount}\r\n                      onChange={(e) => setNewPost(prev => ({ ...prev, hideLikeCount: e.target.checked }))}\r\n                      className=\"rounded border-gray-300 text-orange-600 focus:ring-orange-500\"\r\n                    />\r\n                    <span className=\"text-sm text-gray-700\">Hide like count</span>\r\n                  </label>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between pt-4 border-t border-gray-200\">\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <label className=\"flex items-center space-x-2 text-gray-600 hover:text-orange-600 cursor-pointer\">\r\n                    <Image className=\"w-5 h-5\" />\r\n                    <span className=\"text-sm\">Photo</span>\r\n                    <input\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      onChange={handleImageUpload}\r\n                      className=\"hidden\"\r\n                    />\r\n                  </label>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-3\">\r\n                  <button\r\n                    onClick={() => setShowCreatePost(false)}\r\n                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    onClick={handleCreatePost}\r\n                    disabled={!newPost.content.trim() && !newPost.imageFile}\r\n                    className=\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  >\r\n                    Post\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Follow People Search Modal */}\r\n      {showFollowSearch && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"flex items-center justify-between p-6 border-b border-gray-100\">\r\n              <h2 className=\"text-xl font-semibold text-gray-900\">Find People</h2>\r\n              <button\r\n                onClick={() => setShowFollowSearch(false)}\r\n                className=\"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-full transition-colors\"\r\n              >\r\n                <X className=\"w-5 h-5\" />\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"p-6\">\r\n              <div className=\"mb-6\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Search for people...\"\r\n                  value={searchQuery}\r\n                  onChange={(e) => {\r\n                    setSearchQuery(e.target.value);\r\n                    searchUsers(e.target.value);\r\n                  }}\r\n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                />\r\n              </div>\r\n\r\n              {searchLoading ? (\r\n                <div className=\"flex items-center justify-center py-8\">\r\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-3\">\r\n                  {searchResults.map(user => (\r\n                    <div key={user.id} className=\"flex items-center justify-between p-4 hover:bg-gray-50 rounded-xl transition-colors\">\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <div className=\"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold\">\r\n                          {user.first_name?.charAt(0) || user.username?.charAt(0)}\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"font-medium text-gray-900\">{user.first_name} {user.last_name}</div>\r\n                          <div className=\"text-sm text-gray-500\">@{user.username}</div>\r\n                        </div>\r\n                      </div>\r\n                      <button\r\n                        onClick={() => handleFollow(user.id)}\r\n                        className={`px-4 py-2 rounded-xl font-medium transition-colors ${\r\n                          user.is_following\r\n                            ? 'bg-gray-200 text-gray-700 hover:bg-gray-300'\r\n                            : 'bg-blue-600 text-white hover:bg-blue-700'\r\n                        }`}\r\n                      >\r\n                        {user.is_following ? 'Following' : 'Follow'}\r\n                      </button>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Feed;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}