{"ast":null,"code":"import _objectSpread from\"C:/Users/arian/OneDrive/Desktop/Nutrition/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useAuth}from'../contexts/AuthContext';import{Heart,MessageCircle,Share,MoreHorizontal,PenTool,Bookmark,Image,X}from'lucide-react';import{formatDistanceToNow}from'date-fns';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Feed=()=>{const{user}=useAuth();const[posts,setPosts]=useState([]);const[loading,setLoading]=useState(true);const[showCreatePost,setShowCreatePost]=useState(false);const[newPost,setNewPost]=useState({content:'',imageFile:null,mealData:null,allowComments:true,hideLikeCount:false});const[expandedComments,setExpandedComments]=useState(new Set());const[comments,setComments]=useState({});const[newComments,setNewComments]=useState({});const[loadingComments,setLoadingComments]=useState(new Set());const formatPostDate=dateString=>{const postDate=new Date(dateString);const today=new Date();const isToday=postDate.toDateString()===today.toDateString();if(isToday){return\"Today at \".concat(postDate.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit',hour12:true}));}else{return formatDistanceToNow(postDate,{addSuffix:true});}};useEffect(()=>{if(user){loadFeed();}},[user]);const loadFeed=async()=>{try{const response=await fetch('/api/social/feed',{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();setPosts(data.posts);}}catch(error){console.error('Error loading feed:',error);}finally{setLoading(false);}};const handleLike=async postId=>{try{const response=await fetch(\"/api/social/posts/\".concat(postId,\"/like\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token')),'Content-Type':'application/json'}});if(response.ok){// Update local state\nsetPosts(posts.map(post=>post.id===postId?_objectSpread(_objectSpread({},post),{},{is_liked:!post.is_liked,likes_count:post.is_liked?post.likes_count-1:post.likes_count+1}):post));}}catch(error){console.error('Error liking post:',error);}};const handleCreatePost=async()=>{try{const formData=new FormData();formData.append('content',newPost.content);formData.append('allowComments',newPost.allowComments.toString());formData.append('hideLikeCount',newPost.hideLikeCount.toString());if(newPost.imageFile){formData.append('image',newPost.imageFile);}if(newPost.mealData){formData.append('mealData',JSON.stringify(newPost.mealData));}const response=await fetch('/api/social/posts',{method:'POST',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))},body:formData});if(response.ok){setNewPost({content:'',imageFile:null,mealData:null,allowComments:true,hideLikeCount:false});setShowCreatePost(false);loadFeed();// Reload feed\n}else{const error=await response.json();console.error('Failed to create post:',error);}}catch(error){console.error('Error creating post:',error);}};const loadComments=async postId=>{if(loadingComments.has(postId))return;setLoadingComments(prev=>{const newSet=new Set(prev);newSet.add(postId);return newSet;});try{const response=await fetch(\"/api/social/posts/\".concat(postId,\"/comments\"),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(response.ok){const data=await response.json();setComments(prev=>_objectSpread(_objectSpread({},prev),{},{[postId]:data.comments}));}}catch(error){console.error('Error loading comments:',error);}finally{setLoadingComments(prev=>{const newSet=new Set(prev);newSet.delete(postId);return newSet;});}};const handleToggleComments=postId=>{const isExpanded=expandedComments.has(postId);if(isExpanded){setExpandedComments(prev=>{const newSet=new Set(prev);newSet.delete(postId);return newSet;});}else{setExpandedComments(prev=>{const newSet=new Set(prev);newSet.add(postId);return newSet;});if(!comments[postId]){loadComments(postId);}}};const handleAddComment=async postId=>{var _newComments$postId;const content=(_newComments$postId=newComments[postId])===null||_newComments$postId===void 0?void 0:_newComments$postId.trim();if(!content)return;try{const response=await fetch(\"/api/social/posts/\".concat(postId,\"/comments\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token')),'Content-Type':'application/json'},body:JSON.stringify({content})});if(response.ok){setNewComments(prev=>_objectSpread(_objectSpread({},prev),{},{[postId]:''}));loadComments(postId);// Reload comments\n// Update comments count in posts\nsetPosts(posts.map(post=>post.id===postId?_objectSpread(_objectSpread({},post),{},{comments_count:post.comments_count+1}):post));}}catch(error){console.error('Error adding comment:',error);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto bg-white\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sticky top-0 bg-white border-b border-gray-200 p-4 z-10\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCreatePost(true),className:\"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-4 rounded-lg transition-colors flex items-center justify-center space-x-2\",children:[/*#__PURE__*/_jsx(PenTool,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Create a new post\"})]})}),showCreatePost&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-6 border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-900\",children:\"Create New Post\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreatePost(false),className:\"text-gray-400 hover:text-gray-600 transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"h-6 w-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"textarea\",{value:newPost.content,onChange:e=>setNewPost(_objectSpread(_objectSpread({},newPost),{},{content:e.target.value})),placeholder:\"What's going on?\",className:\"w-full border border-gray-300 rounded-lg p-4 resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\",rows:6})}),newPost.imageFile&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(newPost.imageFile),alt:\"Preview\",className:\"w-full h-64 object-cover rounded-lg\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setNewPost(_objectSpread(_objectSpread({},newPost),{},{imageFile:null})),className:\"absolute top-2 right-2 bg-red-500 text-white rounded-full p-2 hover:bg-red-600 transition-colors shadow-lg\",children:/*#__PURE__*/_jsx(X,{className:\"h-4 w-4\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 mb-3\",children:\"Add to your post\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-4\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg cursor-pointer transition-colors\",children:[/*#__PURE__*/_jsx(Image,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:\"Upload Photo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>{var _e$target$files;const file=(_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){setNewPost(_objectSpread(_objectSpread({},newPost),{},{imageFile:file}));}},className:\"hidden\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 mb-4\",children:\"Privacy Settings\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-700\",children:\"Allow comments\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Let people comment on your post\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setNewPost(_objectSpread(_objectSpread({},newPost),{},{allowComments:!newPost.allowComments})),className:\"relative inline-flex h-6 w-11 items-center rounded-full transition-colors \".concat(newPost.allowComments?'bg-blue-600':'bg-gray-200'),children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-block h-4 w-4 transform rounded-full bg-white transition-transform \".concat(newPost.allowComments?'translate-x-6':'translate-x-1')})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-700\",children:\"Hide like count\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"Only you will see the total number of likes\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setNewPost(_objectSpread(_objectSpread({},newPost),{},{hideLikeCount:!newPost.hideLikeCount})),className:\"relative inline-flex h-6 w-11 items-center rounded-full transition-colors \".concat(newPost.hideLikeCount?'bg-blue-600':'bg-gray-200'),children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-block h-4 w-4 transform rounded-full bg-white transition-transform \".concat(newPost.hideLikeCount?'translate-x-6':'translate-x-1')})})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreatePost(false),className:\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCreatePost,disabled:!newPost.content.trim(),className:\"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors\",children:\"Post\"})]})]})}),posts.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 text-center text-gray-500\",children:[/*#__PURE__*/_jsx(PenTool,{className:\"w-16 h-16 mx-auto mb-4 text-gray-300\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-medium mb-2\",children:\"No posts in your feed\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Follow some users to see their posts here, or create your own post!\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreatePost(true),className:\"mt-4 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors\",children:\"Create your first post\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:posts.map(post=>{var _post$user$first_name,_post$user$username,_user$first_name,_newComments$post$id;return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 border-b border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[post.user.profile_picture?/*#__PURE__*/_jsx(\"img\",{src:post.user.profile_picture,alt:\"\".concat(post.user.first_name,\" \").concat(post.user.last_name),className:\"w-10 h-10 rounded-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-indigo-600 flex items-center justify-center text-white text-sm font-bold\",children:((_post$user$first_name=post.user.first_name)===null||_post$user$first_name===void 0?void 0:_post$user$first_name.charAt(0))||((_post$user$username=post.user.username)===null||_post$user$username===void 0?void 0:_post$user$username.charAt(0))}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold text-gray-900\",children:[post.user.first_name,\" \",post.user.last_name]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:formatPostDate(post.created_at)})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(MoreHorizontal,{className:\"w-5 h-5\"})})]}),post.content&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:post.content})}),post.image_url&&/*#__PURE__*/_jsx(\"div\",{className:\"w-full\",children:/*#__PURE__*/_jsx(\"img\",{src:post.image_url,alt:\"Post\",className:\"w-full object-cover\"})}),post.meal_data&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-800 mb-2\",children:\"Meal Breakdown\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Calories:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 font-medium\",children:post.meal_data.calories})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Protein:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 font-medium\",children:[post.meal_data.protein,\"g\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Carbs:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 font-medium\",children:[post.meal_data.carbs,\"g\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Fat:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 font-medium\",children:[post.meal_data.fat,\"g\"]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-t border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleLike(post.id),className:\"flex items-center space-x-2 transition-colors \".concat(post.is_liked?'text-red-500':'text-gray-400 hover:text-red-500'),children:[/*#__PURE__*/_jsx(Heart,{className:\"w-6 h-6 \".concat(post.is_liked?'fill-current':'')}),!post.hide_like_count||post.user.id===(user===null||user===void 0?void 0:user.id)?/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:post.likes_count}):/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"\\u2022\"})]}),post.allow_comments!==false&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleToggleComments(post.id),className:\"flex items-center space-x-2 text-gray-400 hover:text-gray-600 transition-colors\",children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"w-6 h-6\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:post.comments_count})]}),/*#__PURE__*/_jsx(\"button\",{className:\"text-gray-400 hover:text-gray-600 transition-colors\",children:/*#__PURE__*/_jsx(Share,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"text-gray-400 hover:text-gray-600 transition-colors\",children:/*#__PURE__*/_jsx(Bookmark,{className:\"w-6 h-6\"})})]})}),post.allow_comments!==false&&expandedComments.has(post.id)&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-200\",children:[loadingComments.has(post.id)?/*#__PURE__*/_jsx(\"div\",{className:\"p-4 text-center text-gray-500\",children:\"Loading comments...\"}):comments[post.id]&&comments[post.id].length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 mb-4\",children:comments[post.id].slice(0,3).map(comment=>{var _comment$user$first_n,_comment$user$usernam;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[comment.user.profile_picture?/*#__PURE__*/_jsx(\"img\",{src:comment.user.profile_picture,alt:\"\".concat(comment.user.first_name,\" \").concat(comment.user.last_name),className:\"w-8 h-8 rounded-full object-cover flex-shrink-0\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full bg-gradient-to-br from-green-400 to-blue-600 flex items-center justify-center text-white text-xs font-bold flex-shrink-0\",children:((_comment$user$first_n=comment.user.first_name)===null||_comment$user$first_n===void 0?void 0:_comment$user$first_n.charAt(0))||((_comment$user$usernam=comment.user.username)===null||_comment$user$usernam===void 0?void 0:_comment$user$usernam.charAt(0))}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-100 rounded-lg px-3 py-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium text-sm text-gray-900\",children:[comment.user.first_name,\" \",comment.user.last_name]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-700\",children:comment.content})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mt-1\",children:formatPostDate(comment.created_at)})]})]},comment.id);})}),comments[post.id].length>3&&/*#__PURE__*/_jsxs(\"button\",{className:\"text-sm text-blue-600 hover:text-blue-700 mb-4\",children:[\"View all \",comments[post.id].length,\" comments\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"p-4 text-center text-gray-500\",children:\"No comments yet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-t border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[user!==null&&user!==void 0&&user.profile_picture?/*#__PURE__*/_jsx(\"img\",{src:user.profile_picture,alt:\"\".concat(user.first_name,\" \").concat(user.last_name),className:\"w-8 h-8 rounded-full object-cover flex-shrink-0\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-400 to-pink-600 flex items-center justify-center text-white text-xs font-bold flex-shrink-0\",children:(user===null||user===void 0?void 0:(_user$first_name=user.first_name)===null||_user$first_name===void 0?void 0:_user$first_name.charAt(0))||'U'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newComments[post.id]||'',onChange:e=>setNewComments(prev=>_objectSpread(_objectSpread({},prev),{},{[post.id]:e.target.value})),placeholder:\"Write a comment...\",className:\"flex-1 border border-gray-300 rounded-full px-4 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",onKeyPress:e=>e.key==='Enter'&&handleAddComment(post.id)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAddComment(post.id),disabled:!((_newComments$post$id=newComments[post.id])!==null&&_newComments$post$id!==void 0&&_newComments$post$id.trim()),className:\"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-full text-sm font-medium transition-colors\",children:\"Post\"})]})]})})]})]},post.id);})})]});};export default Feed;","map":{"version":3,"names":["React","useState","useEffect","useAuth","Heart","MessageCircle","Share","MoreHorizontal","PenTool","Bookmark","Image","X","formatDistanceToNow","jsx","_jsx","jsxs","_jsxs","Feed","user","posts","setPosts","loading","setLoading","showCreatePost","setShowCreatePost","newPost","setNewPost","content","imageFile","mealData","allowComments","hideLikeCount","expandedComments","setExpandedComments","Set","comments","setComments","newComments","setNewComments","loadingComments","setLoadingComments","formatPostDate","dateString","postDate","Date","today","isToday","toDateString","concat","toLocaleTimeString","hour","minute","hour12","addSuffix","loadFeed","response","fetch","headers","localStorage","getItem","ok","data","json","error","console","handleLike","postId","method","map","post","id","_objectSpread","is_liked","likes_count","handleCreatePost","formData","FormData","append","toString","JSON","stringify","body","loadComments","has","prev","newSet","add","delete","handleToggleComments","isExpanded","handleAddComment","_newComments$postId","trim","comments_count","className","children","onClick","value","onChange","e","target","placeholder","rows","src","URL","createObjectURL","alt","type","accept","_e$target$files","file","files","disabled","length","_post$user$first_name","_post$user$username","_user$first_name","_newComments$post$id","profile_picture","first_name","last_name","charAt","username","created_at","image_url","meal_data","calories","protein","carbs","fat","hide_like_count","allow_comments","slice","comment","_comment$user$first_n","_comment$user$usernam","onKeyPress","key"],"sources":["C:/Users/arian/OneDrive/Desktop/Nutrition/client/src/components/Feed.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { Heart, MessageCircle, Share, MoreHorizontal, PenTool, Bookmark, Image, X } from 'lucide-react';\r\nimport { formatDistanceToNow } from 'date-fns';\r\n\r\ninterface Post {\r\n  id: number;\r\n  content: string;\r\n  image_url: string | null;\r\n  meal_data: any;\r\n  likes_count: number;\r\n  comments_count: number;\r\n  is_liked: boolean;\r\n  allow_comments?: boolean;\r\n  hide_like_count?: boolean;\r\n  created_at: string;\r\n  user: {\r\n    id: number;\r\n    username: string;\r\n    first_name: string;\r\n    last_name: string;\r\n    profile_picture?: string;\r\n  };\r\n}\r\n\r\ninterface Comment {\r\n  id: number;\r\n  content: string;\r\n  created_at: string;\r\n  user: {\r\n    id: number;\r\n    username: string;\r\n    first_name: string;\r\n    last_name: string;\r\n    profile_picture?: string;\r\n  };\r\n}\r\n\r\nconst Feed: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [posts, setPosts] = useState<Post[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreatePost, setShowCreatePost] = useState(false);\r\n  const [newPost, setNewPost] = useState({ \r\n    content: '', \r\n    imageFile: null as File | null, \r\n    mealData: null,\r\n    allowComments: true,\r\n    hideLikeCount: false\r\n  });\r\n  const [expandedComments, setExpandedComments] = useState<Set<number>>(new Set());\r\n  const [comments, setComments] = useState<{ [postId: number]: Comment[] }>({});\r\n  const [newComments, setNewComments] = useState<{ [postId: number]: string }>({});\r\n  const [loadingComments, setLoadingComments] = useState<Set<number>>(new Set());\r\n\r\n  const formatPostDate = (dateString: string) => {\r\n    const postDate = new Date(dateString);\r\n    const today = new Date();\r\n    const isToday = postDate.toDateString() === today.toDateString();\r\n    \r\n    if (isToday) {\r\n      return `Today at ${postDate.toLocaleTimeString('en-US', { \r\n        hour: 'numeric', \r\n        minute: '2-digit', \r\n        hour12: true \r\n      })}`;\r\n    } else {\r\n      return formatDistanceToNow(postDate, { addSuffix: true });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      loadFeed();\r\n    }\r\n  }, [user]);\r\n\r\n  const loadFeed = async () => {\r\n    try {\r\n      const response = await fetch('/api/social/feed', {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setPosts(data.posts);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading feed:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLike = async (postId: number) => {\r\n    try {\r\n      const response = await fetch(`/api/social/posts/${postId}/like`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n      if (response.ok) {\r\n        // Update local state\r\n        setPosts(posts.map(post => \r\n          post.id === postId \r\n            ? { \r\n                ...post, \r\n                is_liked: !post.is_liked,\r\n                likes_count: post.is_liked ? post.likes_count - 1 : post.likes_count + 1\r\n              }\r\n            : post\r\n        ));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error liking post:', error);\r\n    }\r\n  };\r\n\r\n  const handleCreatePost = async () => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('content', newPost.content);\r\n      formData.append('allowComments', newPost.allowComments.toString());\r\n      formData.append('hideLikeCount', newPost.hideLikeCount.toString());\r\n      \r\n      if (newPost.imageFile) {\r\n        formData.append('image', newPost.imageFile);\r\n      }\r\n      \r\n      if (newPost.mealData) {\r\n        formData.append('mealData', JSON.stringify(newPost.mealData));\r\n      }\r\n\r\n      const response = await fetch('/api/social/posts', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        },\r\n        body: formData\r\n      });\r\n      \r\n      if (response.ok) {\r\n        setNewPost({ \r\n          content: '', \r\n          imageFile: null, \r\n          mealData: null,\r\n          allowComments: true,\r\n          hideLikeCount: false\r\n        });\r\n        setShowCreatePost(false);\r\n        loadFeed(); // Reload feed\r\n      } else {\r\n        const error = await response.json();\r\n        console.error('Failed to create post:', error);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error creating post:', error);\r\n    }\r\n  };\r\n\r\n  const loadComments = async (postId: number) => {\r\n    if (loadingComments.has(postId)) return;\r\n    \r\n    setLoadingComments(prev => {\r\n      const newSet = new Set(prev);\r\n      newSet.add(postId);\r\n      return newSet;\r\n    });\r\n    \r\n    try {\r\n      const response = await fetch(`/api/social/posts/${postId}/comments`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setComments(prev => ({ ...prev, [postId]: data.comments }));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading comments:', error);\r\n    } finally {\r\n      setLoadingComments(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.delete(postId);\r\n        return newSet;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleToggleComments = (postId: number) => {\r\n    const isExpanded = expandedComments.has(postId);\r\n    \r\n    if (isExpanded) {\r\n      setExpandedComments(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.delete(postId);\r\n        return newSet;\r\n      });\r\n    } else {\r\n      setExpandedComments(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.add(postId);\r\n        return newSet;\r\n      });\r\n      if (!comments[postId]) {\r\n        loadComments(postId);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleAddComment = async (postId: number) => {\r\n    const content = newComments[postId]?.trim();\r\n    if (!content) return;\r\n\r\n    try {\r\n      const response = await fetch(`/api/social/posts/${postId}/comments`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ content })\r\n      });\r\n      \r\n      if (response.ok) {\r\n        setNewComments(prev => ({ ...prev, [postId]: '' }));\r\n        loadComments(postId); // Reload comments\r\n        // Update comments count in posts\r\n        setPosts(posts.map(post => \r\n          post.id === postId \r\n            ? { ...post, comments_count: post.comments_count + 1 }\r\n            : post\r\n        ));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding comment:', error);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto bg-white\">\r\n      {/* Create Post Button */}\r\n      <div className=\"sticky top-0 bg-white border-b border-gray-200 p-4 z-10\">\r\n        <button\r\n          onClick={() => setShowCreatePost(true)}\r\n          className=\"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-4 rounded-lg transition-colors flex items-center justify-center space-x-2\"\r\n        >\r\n          <PenTool className=\"w-5 h-5\" />\r\n          <span>Create a new post</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Create Post Modal */}\r\n      {showCreatePost && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n            {/* Modal Header */}\r\n            <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\r\n              <h3 className=\"text-xl font-semibold text-gray-900\">Create New Post</h3>\r\n              <button\r\n                onClick={() => setShowCreatePost(false)}\r\n                className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n              >\r\n                <X className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Modal Body */}\r\n            <div className=\"p-6 space-y-6\">\r\n              {/* Text Input */}\r\n              <div>\r\n                <textarea\r\n                  value={newPost.content}\r\n                  onChange={(e) => setNewPost({ ...newPost, content: e.target.value })}\r\n                  placeholder=\"What's going on?\"\r\n                  className=\"w-full border border-gray-300 rounded-lg p-4 resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors\"\r\n                  rows={6}\r\n                />\r\n              </div>\r\n\r\n              {/* Image Preview */}\r\n              {newPost.imageFile && (\r\n                <div className=\"relative\">\r\n                  <img\r\n                    src={URL.createObjectURL(newPost.imageFile)}\r\n                    alt=\"Preview\"\r\n                    className=\"w-full h-64 object-cover rounded-lg\"\r\n                  />\r\n                  <button\r\n                    onClick={() => setNewPost({ ...newPost, imageFile: null })}\r\n                    className=\"absolute top-2 right-2 bg-red-500 text-white rounded-full p-2 hover:bg-red-600 transition-colors shadow-lg\"\r\n                  >\r\n                    <X className=\"h-4 w-4\" />\r\n                  </button>\r\n                </div>\r\n              )}\r\n\r\n              {/* Upload Controls */}\r\n              <div className=\"border border-gray-200 rounded-lg p-4\">\r\n                <h4 className=\"font-medium text-gray-900 mb-3\">Add to your post</h4>\r\n                <div className=\"flex items-center space-x-4\">\r\n                  <label className=\"flex items-center space-x-2 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg cursor-pointer transition-colors\">\r\n                    <Image className=\"h-5 w-5\" />\r\n                    <span className=\"text-sm font-medium\">Upload Photo</span>\r\n                    <input\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      onChange={(e) => {\r\n                        const file = e.target.files?.[0];\r\n                        if (file) {\r\n                          setNewPost({ ...newPost, imageFile: file });\r\n                        }\r\n                      }}\r\n                      className=\"hidden\"\r\n                    />\r\n                  </label>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Privacy Settings */}\r\n              <div className=\"border border-gray-200 rounded-lg p-4\">\r\n                <h4 className=\"font-medium text-gray-900 mb-4\">Privacy Settings</h4>\r\n                <div className=\"space-y-4\">\r\n                  {/* Allow Comments Toggle */}\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <label className=\"text-sm font-medium text-gray-700\">Allow comments</label>\r\n                      <p className=\"text-xs text-gray-500\">Let people comment on your post</p>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => setNewPost({ ...newPost, allowComments: !newPost.allowComments })}\r\n                      className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                        newPost.allowComments ? 'bg-blue-600' : 'bg-gray-200'\r\n                      }`}\r\n                    >\r\n                      <span\r\n                        className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                          newPost.allowComments ? 'translate-x-6' : 'translate-x-1'\r\n                        }`}\r\n                      />\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Hide Like Count Toggle */}\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <label className=\"text-sm font-medium text-gray-700\">Hide like count</label>\r\n                      <p className=\"text-xs text-gray-500\">Only you will see the total number of likes</p>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => setNewPost({ ...newPost, hideLikeCount: !newPost.hideLikeCount })}\r\n                      className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                        newPost.hideLikeCount ? 'bg-blue-600' : 'bg-gray-200'\r\n                      }`}\r\n                    >\r\n                      <span\r\n                        className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                          newPost.hideLikeCount ? 'translate-x-6' : 'translate-x-1'\r\n                        }`}\r\n                      />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Modal Footer */}\r\n            <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200\">\r\n              <button\r\n                onClick={() => setShowCreatePost(false)}\r\n                className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={handleCreatePost}\r\n                disabled={!newPost.content.trim()}\r\n                className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors\"\r\n              >\r\n                Post\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Feed Posts */}\r\n      {posts.length === 0 ? (\r\n        <div className=\"p-8 text-center text-gray-500\">\r\n          <PenTool className=\"w-16 h-16 mx-auto mb-4 text-gray-300\" />\r\n          <h3 className=\"text-xl font-medium mb-2\">No posts in your feed</h3>\r\n          <p>Follow some users to see their posts here, or create your own post!</p>\r\n          <button\r\n            onClick={() => setShowCreatePost(true)}\r\n            className=\"mt-4 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors\"\r\n          >\r\n            Create your first post\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-6\">\r\n          {posts.map((post) => (\r\n            <div key={post.id} className=\"border border-gray-200 rounded-lg\">\r\n              {/* Post Header */}\r\n              <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  {post.user.profile_picture ? (\r\n                    <img\r\n                      src={post.user.profile_picture}\r\n                      alt={`${post.user.first_name} ${post.user.last_name}`}\r\n                      className=\"w-10 h-10 rounded-full object-cover\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-indigo-600 flex items-center justify-center text-white text-sm font-bold\">\r\n                      {post.user.first_name?.charAt(0) || post.user.username?.charAt(0)}\r\n                    </div>\r\n                  )}\r\n                  <div>\r\n                    <div className=\"font-semibold text-gray-900\">\r\n                      {post.user.first_name} {post.user.last_name}\r\n                    </div>\r\n                    <div className=\"text-sm text-gray-500\">{formatPostDate(post.created_at)}</div>\r\n                  </div>\r\n                </div>\r\n                <button className=\"text-gray-400 hover:text-gray-600\">\r\n                  <MoreHorizontal className=\"w-5 h-5\" />\r\n                </button>\r\n              </div>\r\n\r\n              {/* Post Content */}\r\n              {post.content && (\r\n                <div className=\"p-4\">\r\n                  <p className=\"text-gray-900\">{post.content}</p>\r\n                </div>\r\n              )}\r\n\r\n              {/* Post Image */}\r\n              {post.image_url && (\r\n                <div className=\"w-full\">\r\n                  <img \r\n                    src={post.image_url} \r\n                    alt=\"Post\" \r\n                    className=\"w-full object-cover\"\r\n                  />\r\n                </div>\r\n              )}\r\n\r\n              {/* Meal Data */}\r\n              {post.meal_data && (\r\n                <div className=\"p-4 bg-gray-50 border-t border-gray-200\">\r\n                  <h4 className=\"font-semibold text-gray-800 mb-2\">Meal Breakdown</h4>\r\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                    <div>\r\n                      <span className=\"text-gray-600\">Calories:</span>\r\n                      <span className=\"ml-2 font-medium\">{post.meal_data.calories}</span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-gray-600\">Protein:</span>\r\n                      <span className=\"ml-2 font-medium\">{post.meal_data.protein}g</span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-gray-600\">Carbs:</span>\r\n                      <span className=\"ml-2 font-medium\">{post.meal_data.carbs}g</span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-gray-600\">Fat:</span>\r\n                      <span className=\"ml-2 font-medium\">{post.meal_data.fat}g</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Post Actions */}\r\n              <div className=\"p-4 border-t border-gray-200\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center space-x-4\">\r\n                    <button\r\n                      onClick={() => handleLike(post.id)}\r\n                      className={`flex items-center space-x-2 transition-colors ${\r\n                        post.is_liked ? 'text-red-500' : 'text-gray-400 hover:text-red-500'\r\n                      }`}\r\n                    >\r\n                      <Heart className={`w-6 h-6 ${post.is_liked ? 'fill-current' : ''}`} />\r\n                      {!post.hide_like_count || post.user.id === user?.id ? (\r\n                        <span className=\"text-sm\">{post.likes_count}</span>\r\n                      ) : (\r\n                        <span className=\"text-sm\">â€¢</span>\r\n                      )}\r\n                    </button>\r\n                    {post.allow_comments !== false && (\r\n                      <button \r\n                        onClick={() => handleToggleComments(post.id)}\r\n                        className=\"flex items-center space-x-2 text-gray-400 hover:text-gray-600 transition-colors\"\r\n                      >\r\n                        <MessageCircle className=\"w-6 h-6\" />\r\n                        <span className=\"text-sm\">{post.comments_count}</span>\r\n                      </button>\r\n                    )}\r\n                    <button className=\"text-gray-400 hover:text-gray-600 transition-colors\">\r\n                      <Share className=\"w-6 h-6\" />\r\n                    </button>\r\n                  </div>\r\n                  <button className=\"text-gray-400 hover:text-gray-600 transition-colors\">\r\n                    <Bookmark className=\"w-6 h-6\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Comments Section */}\r\n              {post.allow_comments !== false && expandedComments.has(post.id) && (\r\n                <div className=\"border-t border-gray-200\">\r\n                  {/* Show latest comments */}\r\n                  {loadingComments.has(post.id) ? (\r\n                    <div className=\"p-4 text-center text-gray-500\">Loading comments...</div>\r\n                  ) : comments[post.id] && comments[post.id].length > 0 ? (\r\n                    <div className=\"p-4\">\r\n                      <div className=\"space-y-3 mb-4\">\r\n                        {comments[post.id].slice(0, 3).map((comment) => (\r\n                          <div key={comment.id} className=\"flex space-x-3\">\r\n                            {comment.user.profile_picture ? (\r\n                              <img\r\n                                src={comment.user.profile_picture}\r\n                                alt={`${comment.user.first_name} ${comment.user.last_name}`}\r\n                                className=\"w-8 h-8 rounded-full object-cover flex-shrink-0\"\r\n                              />\r\n                            ) : (\r\n                              <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-green-400 to-blue-600 flex items-center justify-center text-white text-xs font-bold flex-shrink-0\">\r\n                                {comment.user.first_name?.charAt(0) || comment.user.username?.charAt(0)}\r\n                              </div>\r\n                            )}\r\n                            <div className=\"flex-1\">\r\n                              <div className=\"bg-gray-100 rounded-lg px-3 py-2\">\r\n                                <div className=\"font-medium text-sm text-gray-900\">\r\n                                  {comment.user.first_name} {comment.user.last_name}\r\n                                </div>\r\n                                <div className=\"text-sm text-gray-700\">{comment.content}</div>\r\n                              </div>\r\n                              <div className=\"text-xs text-gray-500 mt-1\">\r\n                                {formatPostDate(comment.created_at)}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                      \r\n                      {comments[post.id].length > 3 && (\r\n                        <button className=\"text-sm text-blue-600 hover:text-blue-700 mb-4\">\r\n                          View all {comments[post.id].length} comments\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"p-4 text-center text-gray-500\">No comments yet</div>\r\n                  )}\r\n\r\n                  {/* Add Comment */}\r\n                  <div className=\"p-4 border-t border-gray-100\">\r\n                    <div className=\"flex space-x-3\">\r\n                      {user?.profile_picture ? (\r\n                        <img\r\n                          src={user.profile_picture}\r\n                          alt={`${user.first_name} ${user.last_name}`}\r\n                          className=\"w-8 h-8 rounded-full object-cover flex-shrink-0\"\r\n                        />\r\n                      ) : (\r\n                        <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-400 to-pink-600 flex items-center justify-center text-white text-xs font-bold flex-shrink-0\">\r\n                          {user?.first_name?.charAt(0) || 'U'}\r\n                        </div>\r\n                      )}\r\n                      <div className=\"flex-1 flex space-x-2\">\r\n                        <input\r\n                          type=\"text\"\r\n                          value={newComments[post.id] || ''}\r\n                          onChange={(e) => setNewComments(prev => ({ ...prev, [post.id]: e.target.value }))}\r\n                          placeholder=\"Write a comment...\"\r\n                          className=\"flex-1 border border-gray-300 rounded-full px-4 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                          onKeyPress={(e) => e.key === 'Enter' && handleAddComment(post.id)}\r\n                        />\r\n                        <button\r\n                          onClick={() => handleAddComment(post.id)}\r\n                          disabled={!newComments[post.id]?.trim()}\r\n                          className=\"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-full text-sm font-medium transition-colors\"\r\n                        >\r\n                          Post\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Feed;\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}